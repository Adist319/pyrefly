"use strict";(self.webpackChunknew_website=self.webpackChunknew_website||[]).push([[4129],{14129:(e,n,t)=>{t.r(n),t.d(n,{createRunPythonCodeFunction:()=>_,default:()=>T,initializePyreflyWasm:()=>S});var r=t(96540),o=t(29030),s=t(8532),a=(t(32855),t(74848));const i=40;function l(e,n){e(!0);const t=new Promise((e=>{setTimeout((()=>{e()}),1e3)}));return Promise.all([n(),t]).then((()=>{e(!1)}))}function u(e){let{id:n,onClick:t,defaultLabel:o,runningLabel:s,ariaLabel:i,isRunning:u,setIsRunning:x}=e;void 0!==u&&void 0!==x||([u,x]=(0,r.useState)(!1));const c=u;return(0,a.jsx)("button",{id:n,...{0:{className:"x78zum5 x6s0dn4 x1khhgft x1ypdohk x169l3ba xfo81ep xpivpjv x1vqgdyp xyog2rh x1aq8l9j x1v03e3n x1789zll x1com5t6 x1eqz52 x66in4q x1heor9g x1q0gjfv xxxer0w x1fh9xkg x1ru2czo"},2:{className:"x78zum5 x6s0dn4 x1khhgft x1ypdohk x169l3ba xfo81ep xpivpjv x1vqgdyp xyog2rh x1aq8l9j x1v03e3n x1789zll x1com5t6 x9yugl5 x1awj2ng xrynbky x1q0gjfv x1rpuqfj x4afe7t x1debuo4 x1jutyc x187oe4h x1fh9xkg x1ru2czo"},1:{className:"x78zum5 x6s0dn4 x1khhgft x169l3ba xfo81ep xpivpjv x1vqgdyp xyog2rh x1aq8l9j x1v03e3n x1789zll x1com5t6 x1eqz52 x66in4q x1heor9g x1q0gjfv xxxer0w x1fh9xkg x1ru2czo x1h6gzvc"},3:{className:"x78zum5 x6s0dn4 x1khhgft x169l3ba xfo81ep xpivpjv x1vqgdyp xyog2rh x1aq8l9j x1v03e3n x1789zll x1com5t6 x9yugl5 x1awj2ng xrynbky x1q0gjfv x1rpuqfj x4afe7t x1debuo4 x1jutyc x187oe4h x1fh9xkg x1ru2czo x1h6gzvc"}}[!!u<<1|!!c],onClick:async function(){if(!c)try{l(x,t)}catch(e){console.error("Error in button action:",e)}},"aria-label":i||n,disabled:c,children:(0,a.jsx)("span",{className:"xmtou6a",children:u?s:o})})}let x=function(e){return e.NOT_INITIALIZED="not_initialized",e.INITIALIZING="initializing",e.RUNNING="running",e.FINISHED_RUNNING="finished_running",e}({});function c(e){let{runPython:n,pyodideStatus:t,setPyodideStatus:r}=e;const o=t===x.INITIALIZING||t===x.RUNNING;return(0,a.jsx)(u,{id:"run-python-button",onClick:n,defaultLabel:"\u25b6\ufe0f Run",runningLabel:"\u23f3 Running...",ariaLabel:"run Python code button",isRunning:o,setIsRunning:e=>{r(e?x.RUNNING:x.FINISHED_RUNNING)}})}var d=t(68553),p=t(32992);function h(e){let{error:n,goToDef:t}=e;const{startLineNumber:r,startColumn:s,endLineNumber:i,endColumn:l}=n;let u;u=r===i?s===l?`${r}:${s}`:`${r}:${s}-${l}`:`${r}:${s}-${i}:${l}`;const x=(0,a.jsx)("a",{href:(0,o.default)(`en/docs/error-kinds/#${n.kind}`),target:"_blank",rel:"noopener noreferrer",children:n.kind}),c=`${u}: ${n.message} `;return(0,a.jsxs)("span",{className:"x1ypdohk",onClick:()=>t(r,s,i,l),children:[(0,a.jsx)("span",{className:"x1x2k2ee",children:"ERROR "}),c,"[",x,"]"]})}function f(e){let{loading:n,goToDef:t,errors:r,internalError:o,pythonOutput:s,pyodideStatus:i,activeTab:l,setActiveTab:u=()=>{}}=e;const c=l,d=null!=r&&r.length>0;return(0,a.jsxs)("div",{id:"sandbox-results-container",className:"xh2ww80 x1n2onr6 xfifm61 x1eqz52 xr44f5h",children:[(0,a.jsx)("div",{className:"x78zum5 x1eqz52 xc7mbzt xif65rj",children:(0,a.jsxs)("ul",{className:"x78zum5 xe8uvvx x1ghz6dp x1717udv x67bb7w",children:[(0,a.jsx)("li",{...{0:{className:"x1tc92mu x1ypdohk x117nqv4 x7pa710"},1:{className:"x1tc92mu x1ypdohk x117nqv4 x7pa710 x1eqz52 x16u9nvt x1jyxor1"}}[!("errors"!==c)|0],onClick:()=>u("errors"),children:"Typechecking Errors"}),(0,a.jsx)("li",{...{0:{className:"x1tc92mu x1ypdohk x117nqv4 x7pa710"},1:{className:"x1tc92mu x1ypdohk x117nqv4 x7pa710 x1eqz52 x16u9nvt x1jyxor1"}}[!("output"!==c)|0],onClick:()=>u("output"),children:"Runtime Output"})]})}),(0,a.jsxs)("div",{className:"xysyzu8 x1io82uz",children:[n&&(0,a.jsx)("div",{children:(0,a.jsxs)("div",{className:"x78zum5 xl56j7k x1anpbxc",children:[(0,a.jsx)("div",{className:"x6jxa94 x1v9usgg x18t7k3x xorixrz x1bo1o3z x1sbju2s xa4qsjk x4hg4is x1u6ievf xkf7kw9"}),(0,a.jsx)("div",{className:"x6jxa94 x1v9usgg x18t7k3x xorixrz x1bo1o3z x1sbju2s xa4qsjk x4hg4is x1u6ievf xlzs402"}),(0,a.jsx)("div",{className:"x6jxa94 x1v9usgg x18t7k3x xorixrz x1bo1o3z x1sbju2s xa4qsjk x4hg4is x1u6ievf"})]})}),!n&&"errors"===c&&(0,a.jsx)("pre",{className:"xknfcqp x1awh872 xat24cr x1eqz52",children:(0,a.jsx)("ul",{className:"xe8uvvx x1ghz6dp x1717udv",children:d?r.map(((e,n)=>(0,a.jsx)("li",{...{0:{},1:{className:"x1anpbxc x889kno x19j24cx x1eqz52"}}[!!(n>0)|0],children:(0,a.jsx)(h,{error:e,goToDef:t},n)},n))):(0,a.jsx)("li",{children:o?`Pyrefly encountered an internal error: ${o}.`:null==r?"Pyrefly failed to fetch errors.":0===r?.length?"No errors!":null})})}),"output"===c&&(0,a.jsxs)("pre",{className:"xknfcqp x1awh872 xat24cr x1eqz52",children:[(0,a.jsx)("span",{className:"x14qql8p",children:"Note: The Python runtime currently only supports features up to Python version 3.12, features from newer versions are not available. \n\n"}),i===x.NOT_INITIALIZED?"No output, please press the \u25b6\ufe0f Run button.":i===x.INITIALIZING?"Loading Python interpreter...":i===x.RUNNING?"Running...":s.trimStart()]})]})]})}var m=t(84138);const g=(e,n)=>{throw"not implemented"},y=new Map;const v=(e,n)=>null,b=new Map;const N=(e,n)=>null,k=new Map;const j=()=>[],w=new Map;m.languages.register({id:"python",extensions:[".py"],aliases:["Python"]}),m.languages.registerCompletionItemProvider("python",{triggerCharacters:[".","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","0","1","2","3","4","5","6","7","8","9","[",'"',"'"],provideCompletionItems(e,n){try{const t=y.get(e)??g;return{suggestions:t(n.lineNumber,n.column).map((e=>({...e,insertText:e.label.toString()})))}}catch(t){return console.error(t),null}}}),m.languages.registerDefinitionProvider("python",{provideDefinition(e,n){try{const t=(b.get(e)??v)(n.lineNumber,n.column);return null!=t?{uri:e.uri,range:t}:null}catch(t){return console.error(t),null}}}),m.languages.registerHoverProvider("python",{provideHover:(e,n)=>(k.get(e)??N)(n.lineNumber,n.column)}),m.languages.registerInlayHintsProvider("python",{provideInlayHints:e=>({hints:(w.get(e)??j)(),dispose:()=>{}})}),d.wG.config({monaco:m});const z='\n# Welcome to the Pyrefly Sandbox, this is a page\n# where you can write, share and learn about typing in Python.\n#\n# Here are a couple features of this sandbox:\n# - Get real-time type checking feedback\n# - Use reveal_type() to inspect inferred types\n# - experiment with the IDE features that we support (e.g. autocomplete, go-to-definition, hover, etc)\n# - Write and run Python code directly in your browser\n\nfrom typing import *\n\ndef test(x: int):\n  return f"{x}"\n\n# reveal_type will produce a type error that tells you the type Pyrefly has\n# computed for the return (in this case, str)\nreveal_type(test(42))\n'.trimStart();let I=null,q=null,L=null;const C=async e=>{if(I&&L)return L(""),new Promise((n=>{q=n,I?.postMessage(e)}));console.error("Python worker not initialized. Call initializePythonWorker first.")},P=e=>{let{setPythonOutput:n,setPyodideStatus:o}=e;return(0,r.useEffect)((()=>(null===I&&((e,n)=>{if(null!==I)return;L=e;const r=new Worker(new URL(t.p+t.u(8123),t.b),{type:void 0});r.onmessage=t=>{const r=t.data;switch(r.type){case"stdout":case"stderr":return void e((e=>e+"\n"+r.output));case"pyodideStatusUpdate":return void n(r.status);case"runPython":return!r.success&&r.error&&e((e=>e+"\n"+`Error: ${r.error}`)),void(q&&(q(),q=null));default:console.error(`Unknown message type received from worker: ${r}`)}},I=r})(n,o),()=>{})),[n,o]),{runPython:C}};async function S(){const e="undefined"!=typeof window?t.e(3190).then(t.bind(t,93190)):new Promise((e=>{}));try{const n=await e;return await n.default(),await n}catch(n){throw console.error(n),n}}let R=null;function T(e){let{sampleFilename:n,isCodeSnippet:t=!1,codeSample:o=z}=e;const s=(0,r.useRef)(null),[c,d]=(0,r.useState)([]),[p,h]=(0,r.useState)(""),[g,v]=(0,r.useState)(!0),[N,j]=(0,r.useState)(null),[I,q]=(0,r.useState)(null),[L,C]=(0,r.useState)(null),[T,E]=(0,r.useState)(x.NOT_INITIALIZED),[H,V]=(0,r.useState)(""),[Z,F]=(0,r.useState)("errors"),[W,B]=(0,r.useState)(!1);function J(){if(null!=L&&null!=N){!function(e,n){y.set(e,n)}(L,((e,n)=>N.autoComplete(e,n))),function(e,n){b.set(e,n)}(L,((e,n)=>N.gotoDefinition(e,n))),function(e,n){k.set(e,n)}(L,((e,n)=>N.queryType(e,n))),function(e,n){w.set(e,n)}(L,(()=>N.inlayHint()));try{const e=L.getValue();N.updateSource(e);const n=N.getErrors();m.editor.setModelMarkers(L,"default",function(e){return e.map((e=>({startLineNumber:e.startLineNumber,startColumn:e.startColumn,endLineNumber:e.endLineNumber,endColumn:e.endColumn,message:e.message,severity:e.severity})))}(n)),h(""),d(n)}catch(e){console.error(e),h(JSON.stringify(e)),d([])}}}(0,r.useEffect)((()=>{v(!0),R||(R=S()),R.then((e=>{j(new e.State),v(!1),h("")})).catch((e=>{v(!1),h(JSON.stringify(e))}))}),[]),m.editor.onDidCreateModel((e=>{const t=U(n);C(t),J()})),(0,r.useEffect)((()=>{J()}),[N,L]);const{runPython:K}=P({setPythonOutput:V,setPyodideStatus:E}),Q=_(F,K),X=(0,r.useCallback)((async()=>{L&&(E(x.RUNNING),await Q(L))}),[L,F,E]);return(0,a.jsxs)("div",{id:"sandbox-editor",className:"x78zum5 xdt5ytf x98rzlu",children:[(0,a.jsxs)("div",{id:"sandbox-code-editor-container",...{0:{className:"x1n2onr6 x78zum5 x1rea2x4 x7hct1x x1eqz52 x5yr21d"},1:{className:"x1n2onr6 x78zum5 x7hct1x x1eqz52 x5yr21d x66in4q x16eypsj xb3r6kr"}}[!!t|0],onMouseEnter:()=>B(!0),onMouseLeave:()=>B(!1),children:[$(t,n,o,J,(function(e){const r=U(n);if(C(r),t){const n=M()?i+5:0;q(Math.max(50,e.getContentHeight()+n))}s.current=e,e.addCommand(m.KeyMod.CtrlCmd|m.KeyCode.Enter,(()=>{if(!t&&T!==x.INITIALIZING&&T!==x.RUNNING){const n=e.getModel();n&&l((e=>E(e?x.RUNNING:x.FINISHED_RUNNING)),(async()=>{await Q(n)}))}}))}),I),(0,a.jsxs)("div",{...{0:{className:"x10l6tqk x78zum5 x1q0g3np x1n327nk xmhk92p xk6ci0l xg01cxk xlshs6z x17ce4s4"},2:{className:"x10l6tqk x78zum5 x1q0g3np x1n327nk x191j7n5 xn5hqff xg01cxk xlshs6z x17ce4s4"},1:{className:"x10l6tqk x78zum5 x1q0g3np x1n327nk xmhk92p xk6ci0l x1hc1fzr xnpuxes x17ce4s4"},3:{className:"x10l6tqk x78zum5 x1q0g3np x1n327nk x191j7n5 xn5hqff x1hc1fzr xnpuxes x17ce4s4"}}[!!M()<<1|!(t&&!W&&!M())],children:[t?null:O(X,T,E),t?null:(0,a.jsx)(u,{id:"share-url-button",onClick:()=>{const e=window.location.href;return navigator.clipboard.writeText(e)},defaultLabel:"\ud83d\udccb Share URL",runningLabel:"\u2713 URL Copied!",ariaLabel:"share URL button"}),t?(0,a.jsx)(G,{model:L}):null,t?D(L):null,t&&M()?null:A(L,J,o,t)]})]}),!t&&(0,a.jsx)(f,{loading:g,goToDef:(e,n,t,r)=>{const o=s.current;if(null===o)return;const a={startLineNumber:e,startColumn:n,endLineNumber:t,endColumn:r};o.revealRange(a),o.setSelection(a)},errors:c,internalError:p,pythonOutput:H,pyodideStatus:T,activeTab:Z,setActiveTab:F})]})}function E(e){const n=p.compressToEncodedURIComponent(e),t=`${window.location.pathname}?code=${n}`;window.history.replaceState({},"",t)}function U(e){const n=m.editor.getModels().filter((n=>n?.uri?.path===`/${e}`))[0];if(null==n)return null;const t=function(){if("undefined"==typeof window)return null;const e=new URLSearchParams(window.location.search).get("code");return e?p.decompressFromEncodedURIComponent(e):null}();return null!=t&&null!=n&&n.setValue(t),n.setValue(n.getValue()),n.updateOptions({tabSize:4,insertSpaces:!0}),n}function M(){return/iPhone|iPad|iPod|Android/i.test(navigator.userAgent)}function $(e,n,t,r,o,i){const{colorMode:l}=s.G(),u="dark"===l?"vs-dark":"vs-light";if(e)return(0,a.jsx)(d.Ay,{defaultPath:n,defaultValue:t,defaultLanguage:"python",theme:u,onChange:r,onMount:o,keepCurrentModel:!0,height:i,options:{readOnly:M(),domReadOnly:M(),minimap:{enabled:!1},hover:{enabled:!0,above:!1},scrollBeyondLastLine:!1,overviewRulerBorder:!1}});{const e=window.innerHeight,s=document.querySelector(".navbar"),i=75*(e-(s?.offsetHeight||0))/100;return(0,a.jsx)(d.Ay,{defaultPath:n,defaultValue:t,defaultLanguage:"python",theme:u,onChange:e=>{r(),"string"==typeof e&&E(e)},onMount:o,keepCurrentModel:!0,height:i,options:{minimap:{enabled:!1},hover:{enabled:!0,above:!1},scrollBeyondLastLine:!1,overviewRulerBorder:!1}})}}function G(e){let{model:n}=e;const t=(0,o.default)("sandbox/");return(0,a.jsx)(u,{id:"open-sandbox-button",onClick:async()=>{if(n){const e=n.getValue(),r=p.compressToEncodedURIComponent(e),o=t+`?code=${r}`;window.location.href=o}return Promise.resolve()},defaultLabel:"\ud83e\uddea Open in Sandbox",runningLabel:"\u23f3 Opening Sandbox...",ariaLabel:"open in sandbox"})}function O(e,n,t){return(0,a.jsx)(c,{runPython:e,pyodideStatus:n,setPyodideStatus:t})}function D(e){return(0,a.jsx)(u,{id:"copy-code-button",onClick:async()=>{if(e){const n=e.getValue();await navigator.clipboard.writeText(n)}return Promise.resolve()},defaultLabel:"\ud83d\udccb Copy",runningLabel:"\u2713 Copied!",ariaLabel:"copy code to clipboard"})}function A(e,n,t,r){return(0,a.jsx)(u,{id:"reset-button",onClick:async()=>{e&&(e.setValue(t),r||E(t),n())},defaultLabel:"\ud83d\udd04 Reset",runningLabel:"\u2713 Reset!",ariaLabel:"reset to default code"})}function _(e,n){return async t=>{if(!t)return;e("output");const r=t.getValue();await n(r)}}}}]);